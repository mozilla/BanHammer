{% extends "base.html" %}


{% block content %}
	<h1>Blacklists</h1>
	<div class="row">
	    <div class="offset5 span2 center bold alert alert-info">
	    	All times are in UTC
	    </div>
    </div>
	<div class="row">
		<div class="span2">
			<a class="btn btn-primary" href="/blacklist/post/">
				<i class="icon-white icon-plus-sign"></i>
				Add new blacklist
			</a>
		</div>
		<div class="span3 pull-right">
			{% if data.show_expired == False %}
				<a class="btn" href="/blacklist/show_expired">Show Expired Blacklists</a>
			{% else %}
				<a class="btn btn-info" href="/blacklist">Hide Expired Blacklists</a>
			{% endif %}
		</div>
	</div>
	<br />
	<table class="table">
	<tr>
		<th>
		    Address
		    <a href='?order_by=address&order=asc'><img src='/static/images/bullet-arrow-up.gif'></a>
		    <a href='?order_by=address&order=desc'><img src='/static/images/bullet-arrow-down.gif'></a>
		</th>
		<th>
		    CIDR
		    <a href='?order_by=cidr&order=asc'><img src='/static/images/bullet-arrow-up.gif'></a>
		    <a href='?order_by=cidr&order=desc'><img src='/static/images/bullet-arrow-down.gif'></a>
		</th>
		<th>
		    Created
		    <a href='?order_by=start_date&order=asc'><img src='/static/images/bullet-arrow-up.gif'></a>
		    <a href='?order_by=start_date&order=desc'><img src='/static/images/bullet-arrow-down.gif'></a>
		</th>
		<th class="center">
		    Expires
		    <a href='?order_by=end_date&order=asc'><img src='/static/images/bullet-arrow-up.gif'></a>
		    <a href='?order_by=end_date&order=desc'><img src='/static/images/bullet-arrow-down.gif'></a>
		</th>
		<th class="center">
		    Reporter
		    <a href='?order_by=reporter&order=asc'><img src='/static/images/bullet-arrow-up.gif'></a>
		    <a href='?order_by=reporter&order=desc'><img src='/static/images/bullet-arrow-down.gif'></a>
		</th>
		<th class="center">
		    <img src="{{ static('images/link.png') }}">
		</th>
		<th class="center">
		    <img src="{{ static('images/comment.gif') }}">
		</th>
		<th class="center">
		    <img src="{{ static('images/delete.gif') }}">
		</th>
	</tr>
	{% for b in blacklists %}
		{% if b.expired() %}
		<tr class='info'>
		{% else %}
		<tr>
		{% endif %}
	    <td class="left">{{ b.offender.address }}</td>
	    <td class="left">/{{ b.offender.cidr }}</td>
	    <td class="center">{{ b.start_date.strftime('%Y-%m-%d %H:%m') }}</td>
	    <td class="center">{{ b.end_date.strftime('%Y-%m-%d %H:%m') }}</td>
	    <td class="center">{{ b.reporter }}</td>
	    <td class="center">{% if b.bug_number %}
	    <a href="https://bugzilla.mozilla.org/show_bug.cgi?id={{b.bug_number}}">
	    <img src="{{ static('images/link.png') }}">
	    </a>
	    {% endif %}</td>
	    <td class="center"><img title='{{b.comment}}' src="{{ static('images/comment.gif') }}"></td>
	    <td class="center">
	    <a href="/blacklist/delete/?id={{b.id}}">
	    <img src="{{ static('images/delete.gif') }}">
	    </a>
	    </td>
	    </tr>
	{% endfor %}
	
	{% if not blacklists %}
	<tr><td colspan="7" class="empty">
	<div class="banner">No active blacklists.</div>
	</td></tr>
	{% endif %}
	
	</table>
{% endblock %}
